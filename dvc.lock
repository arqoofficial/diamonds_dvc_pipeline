schema: '2.0'
stages:
  drop-dup:
    cmd: python3 scripts/data_scripts/drop_dup.py data/raw/diamonds.csv
    deps:
    - path: data/raw/diamonds.csv
      hash: md5
      md5: bb67f2679c70a62b35220f7e90a6174a
      size: 3192560
    - path: scripts/data_scripts/drop_dup.py
      hash: md5
      md5: 50f8ab478a1b9a33462901e35b3dbb58
      size: 1173
    outs:
    - path: data/stage1/
      hash: md5
      md5: ecca97e1e526cb852d82e606350ace0d.dir
      size: 2565059
      nfiles: 1
  drop-na:
    cmd: python3 scripts/data_scripts/drop_na.py data/stage1/diamonds.csv
    deps:
    - path: data/stage1/diamonds.csv
      hash: md5
      md5: a914e1a1f8a4605df22bc632448b85e0
      size: 2565059
    - path: scripts/data_scripts/drop_na.py
      hash: md5
      md5: 243afceec655083db1e0f53ff05a66df
      size: 1105
    outs:
    - path: data/stage2/
      hash: md5
      md5: ecca97e1e526cb852d82e606350ace0d.dir
      size: 2565059
      nfiles: 1
  drop-outliers:
    cmd: python3 scripts/data_scripts/drop_outliers.py data/stage2/diamonds.csv
    deps:
    - path: data/stage2/diamonds.csv
      hash: md5
      md5: a914e1a1f8a4605df22bc632448b85e0
      size: 2565059
    - path: scripts/data_scripts/drop_outliers.py
      hash: md5
      md5: c3033ea58a713141e6504fede8cf5658
      size: 1889
    params:
      params.yaml:
        drop_outliers.carat.max: 3
        drop_outliers.carat.min: 0
        drop_outliers.depth.max: 70
        drop_outliers.depth.min: 55
        drop_outliers.price.max:
        drop_outliers.price.min:
        drop_outliers.table.max: 70
        drop_outliers.table.min: 50
        drop_outliers.x.min: 3
        drop_outliers.y.max: 10
        drop_outliers.z.max: 6
    outs:
    - path: data/stage3/
      hash: md5
      md5: 0cbe15cde840068bfec9ed342c9ac686.dir
      size: 2559339
      nfiles: 1
  preprocessors:
    cmd: python3 scripts/data_scripts/preprocessors.py data/stage3/diamonds.csv
    deps:
    - path: data/stage3/diamonds.csv
      hash: md5
      md5: 6ef72a1ffda63c15c266d49872e47902
      size: 2559339
    - path: scripts/data_scripts/preprocessors.py
      hash: md5
      md5: 0616922b9646b98c1d31d134ec70d69d
      size: 3111
    params:
      params.yaml:
        preprocessors.PF_degree: 3
        preprocessors.PF_interaction: false
        preprocessors.scalers: minmax
        preprocessors.target: price
    outs:
    - path: data/stage4/
      hash: md5
      md5: dfdf94951d744d82b464a8b8c1d1f283.dir
      size: 91629729
      nfiles: 1
  split:
    cmd: python3 scripts/data_scripts/train_test_split.py data/stage4/diamonds.csv
    deps:
    - path: data/stage4/diamonds.csv
      hash: md5
      md5: 1b72c524243729b540f6d2903718bec9
      size: 91629729
    - path: scripts/data_scripts/train_test_split.py
      hash: md5
      md5: 7502d640513045267e54f21aea96db89
      size: 2085
    params:
      params.yaml:
        split.seed: 42
        split.split_ratio: 0.3
        split.target: price
    outs:
    - path: data/stage5/
      hash: md5
      md5: 48000e8ed26ba692737d41997f9cbd52.dir
      size: 88105754
      nfiles: 2
  train:
    cmd: python3 scripts/model_scripts/model_knr.py data/stage5/train.csv model_knr
    deps:
    - path: data/stage5/train.csv
      hash: md5
      md5: c561d72a6ed86aadf0b389d23448eb7b
      size: 61671498
    - path: scripts/model_scripts/model_knr.py
      hash: md5
      md5: 403914c9ce062e4c6786641530c3dac3
      size: 1999
    params:
      params.yaml:
        train.n_neighbors: 8
        train.target: price
        train.weights: distance
    outs:
    - path: models/
      hash: md5
      md5: b56f2e0a429ce97672f1acf1a0d035a1.dir
      size: 31260514
      nfiles: 1
  evaluate:
    cmd: python3 scripts/model_scripts/evaluate.py data/stage5/test.csv models/model_knr.pkl
    deps:
    - path: data/stage5/test.csv
      hash: md5
      md5: 5e7178412238e8987ec06459b3edf533
      size: 26434256
    - path: models/model_knr.pkl
      hash: md5
      md5: e286eb5b970b1cc958c2367ba3bef488
      size: 31260514
    - path: scripts/model_scripts/evaluate.py
      hash: md5
      md5: 275765a71e2e4d4c080126233b3b443a
      size: 2798
    params:
      params.yaml:
        train.n_neighbors: 8
        train.target: price
        train.weights: distance
    outs:
    - path: evaluate/scores_extended.json
      hash: md5
      md5: 3ef21d4ead86037a44cb4a5f522f01a5
      size: 60
